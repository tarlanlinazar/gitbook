openapi: 3.0.1
info:
  title: OpenAPI definition
  version: v0
servers:
  - url: https://develop.m10payments.com/online-acquiring
    description: Generated server url
paths:
  /api/v1/user-tokenization/actions/create:
    post:
      tags:
        - user-tokenization-controller
      operationId: create
      parameters:
        - name: X-User-Locale
          in: header
          description: User locale
          required: false
          schema:
            type: string
            description: User locale
            example: en-GB
          example: en-GB
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTokenizationRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/CreateTokenizationResponse'
      security:
        - Merchant: []
  /api/v1/qr-data/orders/status:
    post:
      tags:
        - qr-page-data-controller
      operationId: orderStatus
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QrDataRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseDtoQrStatusDto'
  /api/v1/qr-data/orders/info:
    post:
      tags:
        - qr-page-data-controller
      operationId: orderInfo
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QrDataRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseDtoQrData'
  /api/v1/orders/actions/create-refund:
    post:
      tags:
        - order-controller
      operationId: createRefundOrder
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateRefundRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/CreateRefundResponse'
      security:
        - Merchant: []
  /api/v1/orders/actions/create-payment:
    post:
      tags:
        - order-controller
      operationId: createPaymentOrder
      parameters:
        - name: X-User-Token
          in: header
          description: Header with token when user has m10 as saved payment method
          required: false
          schema:
            type: string
            description: Header with token when user has m10 as saved payment method
            example: b8ec7167-e408-4211-8deb-ae38e65d281a
          example: b8ec7167-e408-4211-8deb-ae38e65d281a
        - name: X-User-Locale
          in: header
          description: User locale
          required: false
          schema:
            type: string
            description: User locale
            example: en-GB
          example: en-GB
        - name: X-User-Tokenization
          in: header
          description: User token processing mode
          required: true
          schema:
            type: string
            description: User token processing mode
            default: NOT_REQUIRED
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreatePaymentRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/CreatePaymentResponse'
      security:
        - Merchant: []
  /api/v1/m10/operation/info:
    post:
      tags:
        - m-10-user-controller
      operationId: paymentInfo
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OperationInfoRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseDtoOperationInfoResponse'
      security:
        - m10: []
  /api/v1/m10/token/info:
    post:
      tags:
        - m-10-user-controller
      operationId: paymentInfo_1
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OperationInfoRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseDtoOperationInfoResponse'
      security:
        - m10: []
  /api/v1/m10/payment/info:
    post:
      tags:
        - m-10-user-controller
      operationId: paymentInfo_2
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OperationInfoRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseDtoOperationInfoResponse'
      security:
        - m10: []
  /api/v1/m10/operation:
    post:
      tags:
        - m-10-user-controller
      operationId: payment
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OperationDecisionRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseDtoOperationDecisionResponse'
      security:
        - m10: []
  /api/v1/m10/token:
    post:
      tags:
        - m-10-user-controller
      operationId: payment_1
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OperationDecisionRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseDtoOperationDecisionResponse'
      security:
        - m10: []
  /api/v1/m10/payment:
    post:
      tags:
        - m-10-user-controller
      operationId: payment_2
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OperationDecisionRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseDtoOperationDecisionResponse'
      security:
        - m10: []
  /api/v1/user-tokenization/{tokenizationId}:
    get:
      tags:
        - user-tokenization-controller
      operationId: get
      parameters:
        - name: tokenizationId
          in: path
          description: tokenizationId supplied by merchant in the initial request
          required: true
          schema:
            pattern: '[a-zA-Z0-9_-]{20,64}'
            type: string
            description: tokenizationId supplied by merchant in the initial request
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/UserTokenizationDto'
      security:
        - Merchant: []
  /api/v1/transactions/{transactionId}:
    get:
      tags:
        - transaction-controller
      operationId: getTransaction
      parameters:
        - name: transactionId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/TransactionDto'
      security:
        - Merchant: []
  /api/v1/qr-data/stream/orders/{operationId}/status:
    get:
      tags:
        - qr-page-data-stream-controller
      operationId: orderStatus_1
      parameters:
        - name: operationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/SseEmitter'
  /api/v1/orders/{orderId}:
    get:
      tags:
        - order-controller
      operationId: getOrder
      parameters:
        - name: orderId
          in: path
          description: orderId supplied by merchant in the initial request
          required: true
          schema:
            pattern: '[a-zA-Z0-9_-]{20,64}'
            type: string
            description: orderId supplied by merchant in the initial request
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/OrderDto'
      security:
        - Merchant: []
components:
  schemas:
    CreateTokenizationRequest:
      required:
        - orderId
      type: object
      properties:
        orderId:
          pattern: '[a-zA-Z0-9_-]{20,64}'
          type: string
          description: Unique operation id for this merchant provided by the merchant
        confirmURL:
          type: string
          description: Dynamic link or URL to redirect user if tokenization was successful
          example: https://merchant.com/success/{tokenizationId}
        cancelURL:
          type: string
          description: Dynamic link or URL to redirect user if tokenization was canceled by user
          example: https://merchant.com/cancel/{tokenizationId}
        errorURL:
          type: string
          description: Dynamic link or URL to redirect user if there was an error during tokenization process
          example: https://merchant.com/error/{tokenizationId}
        userdata:
          type: string
          description: Any userdata, not parsed on m10 side, returned unchanged in callback
        metadata:
          type: object
          additionalProperties:
            type: object
            description: Additional merchant specific parameters
          description: Additional merchant specific parameters
      description: Request from merchant to create tokenization on m10
    CreateTokenizationResponse:
      required:
        - tokenizationUrl
      type: object
      properties:
        tokenizationUrl:
          type: string
          description: URL for merchant to show m10 tokenization page to user
          format: url
          example: https://api.m10.az/online-payments/tokenization/{tokenizationId}
        operationId:
          type: string
          description: Operation id of the created tokenization request.
          example: c8b1a4fa-e846-42d8-a53f-76d62d14f1d6
      description: Response to merchant for user tokenization on m10
    QrDataRequest:
      required:
        - operationId
      type: object
      properties:
        operationId:
          type: string
          format: uuid
    QrStatusDto:
      type: object
      properties:
        status:
          type: string
          enum:
            - CREATED
            - IN_PROGRESS
            - SUCCESS
            - FAILURE
            - CANCEL
            - EXPIRED
    ResponseDtoQrStatusDto:
      required:
        - status
      type: object
      properties:
        payload:
          $ref: '#/components/schemas/QrStatusDto'
        status:
          $ref: '#/components/schemas/Status'
    Status:
      required:
        - code
        - description
      type: object
      properties:
        code:
          type: string
          example: onlineAcquiring-400001
        description:
          type: string
          example: User payment init success
    QrData:
      required:
        - amount
        - currency
        - operationType
        - remainingDuration
      type: object
      properties:
        amount:
          type: string
          description: Amount of the order
          example: '10.99'
        currency:
          type: string
          description: Currency of the order
          example: AZN
          enum:
            - AZN
            - USD
            - EUR
            - RUR
        remainingDuration:
          type: integer
          description: Remaining duration in seconds after which the payment will be expired
          format: int64
          example: 30
        operationType:
          type: string
          description: Operation type to display QR for.
          example: PAYMENT
          enum:
            - PAYMENT
            - TOKENIZATION
            - UNSUPPORTED
        successURL:
          type: string
          description: URL to redirect user in case of success payment
          example: https://merchant.com/success/{orderId}
        cancelURL:
          type: string
          description: URL to redirect user in case payment was canceled
          example: https://merchant.com/cancel/{orderId}
        errorURL:
          type: string
          description: URL to redirect user in case of error
          example: https://merchant.com/error/{orderId}
    ResponseDtoQrData:
      required:
        - status
      type: object
      properties:
        payload:
          $ref: '#/components/schemas/QrData'
        status:
          $ref: '#/components/schemas/Status'
    CreateRefundRequest:
      required:
        - amount
        - currencyISO
        - orderId
        - originalTransactionId
      type: object
      properties:
        orderId:
          pattern: '[a-zA-Z0-9_-]{20,64}'
          type: string
          description: Unique order id for this merchant provided by the merchant
        originalTransactionId:
          type: string
          description: Id of successful payment obtained from m10
          format: uuid
        currencyISO:
          type: string
          description: CurrencyISO of the transaction
          example: AZN
          enum:
            - AZN
            - USD
            - EUR
            - RUR
        amount:
          type: string
          description: Amount to refund. Can be less than total payment amount. Sum of all refunds for the payment must not exceed total payment amount
          example: '10.51'
        userdata:
          type: string
          description: Any userdata, not parsed on m10 side, returned unchanged in callback
        metadata:
          type: object
          additionalProperties:
            type: object
            description: Additional merchant specific parameters
          description: Additional merchant specific parameters
      description: Request from merchant to execute full or partial refund
    CreateRefundResponse:
      type: object
      properties:
        transactionId:
          type: string
          description: Transaction id of the created refund.
          example: c8b1a4fa-e846-42d8-a53f-76d62d14f1d6
      description: Response to merchant for refund of the payment on m10
    CreatePaymentRequest:
      required:
        - amount
        - currencyISO
        - orderId
      type: object
      properties:
        orderId:
          pattern: '[a-zA-Z0-9_-]{20,64}'
          type: string
          description: Unique order id for this merchant provided by the merchant
        currencyISO:
          type: string
          description: CurrencyISO of the transaction
          example: AZN
          enum:
            - AZN
            - USD
            - EUR
            - RUR
        amount:
          type: string
          description: Amount of the transaction
          example: '10.51'
        confirmURL:
          type: string
          description: URL to redirect user in case of success payment
          example: https://merchant.com/success/{orderId}
        cancelURL:
          type: string
          description: URL to redirect user in case payment was canceled
          example: https://merchant.com/cancel/{orderId}
        errorURL:
          type: string
          description: URL to redirect user in case of error
          example: https://merchant.com/error/{orderId}
        extKycInfo:
          $ref: '#/components/schemas/ExternalKycInfo'
        userdata:
          type: string
          description: Any userdata, not parsed on m10 side, returned unchanged in callback
        metadata:
          type: object
          additionalProperties:
            type: object
            description: Additional merchant specific parameters
          description: Additional merchant specific parameters
      description: Request from merchant to create payment on m10
    ExternalKycInfo:
      title: ExternalKycInfo - user kyc data.
      type: object
      properties:
        firstName:
          maxLength: 100
          minLength: 0
          type: string
        lastName:
          maxLength: 100
          minLength: 0
          type: string
        middleName:
          maxLength: 100
          minLength: 0
          type: string
        birthdate:
          maxLength: 100
          minLength: 0
          type: string
        nationality:
          maxLength: 100
          minLength: 0
          type: string
    CreatePaymentResponse:
      required:
        - paymentURL
      type: object
      properties:
        paymentURL:
          type: string
          description: URL for merchant to show m10 payment page to user
          format: url
          example: https://link.develop.m10payments.com/?link=https://api.m10.az/acquiring?operationId=c8b1a4fa-e846-42d8-a53f-76d62d14f1d6&apn=com.m10&isi=1642308007&ibi=com.m10.ios
        transactionId:
          type: string
          description: Transaction id of the created payment.
          example: c8b1a4fa-e846-42d8-a53f-76d62d14f1d6
      description: Response to merchant for create payment on m10
    OperationInfoRequest:
      required:
        - operationId
      type: object
      properties:
        operationId:
          type: string
          description: Id of the operation which was created by a merchant
          format: uuid
    MerchantInfo:
      required:
        - iconUrl
        - merchantId
        - merchantName
      type: object
      properties:
        iconUrl:
          type: string
          description: Full path to a merchant icon
          example: https://dfy2j7f1krq5a.cloudfront.net/merchants/binance.png
        merchantName:
          type: string
          description: Merchant name
          example: Binance
        merchantId:
          type: string
          description: Id of a merchant
          example: 85211808-d20a-4f8e-9cb3-b4b02ff70392
    Money:
      required:
        - amount
        - currency
      type: object
      properties:
        amount:
          type: string
          description: Amount of the order
          example: '10.99'
        currency:
          type: string
          description: Currency of the order
          example: AZN
          enum:
            - AZN
            - USD
            - EUR
            - RUR
    OperationAttributes:
      type: object
      properties:
        operationType:
          type: string
          enum:
            - PAYMENT
            - TOKENIZATION
        tokenizationRequired:
          type: boolean
    OperationInfoResponse:
      required:
        - merchantInfo
        - money
        - operationAttributes
      type: object
      properties:
        money:
          $ref: '#/components/schemas/Money'
        merchantInfo:
          $ref: '#/components/schemas/MerchantInfo'
        operationAttributes:
          $ref: '#/components/schemas/OperationAttributes'
        approveBackLink:
          type: string
        declineBackLink:
          type: string
    ResponseDtoOperationInfoResponse:
      required:
        - status
      type: object
      properties:
        payload:
          $ref: '#/components/schemas/OperationInfoResponse'
        status:
          $ref: '#/components/schemas/Status'
    OperationDecisionRequest:
      required:
        - accountId
        - operationId
        - type
      type: object
      properties:
        operationId:
          type: string
          description: Id of the operation which was created by a merchant
          format: uuid
        accountId:
          type: string
        type:
          type: string
          enum:
            - CONFIRM
            - DECLINE
    OperationDecisionResponse:
      required:
        - backLink
        - operationOutcome
      type: object
      properties:
        backLink:
          type: string
          description: A link to redirect a user
          example: https://site.com/link/to/redirect
        operationOutcome:
          type: string
          description: Result of processing user decision on server
          example: SUCCESS
          enum:
            - SUCCESS
            - ERROR
            - CANCELLATION
    ResponseDtoOperationDecisionResponse:
      required:
        - status
      type: object
      properties:
        payload:
          $ref: '#/components/schemas/OperationDecisionResponse'
        status:
          $ref: '#/components/schemas/Status'
    UserTokenizationDto:
      required:
        - id
      type: object
      properties:
        id:
          pattern: '[a-zA-Z0-9_-]{20,64}'
          type: string
          description: Unique tokenization id for this merchant provided by the merchant
        userToken:
          type: string
          description: Token for quick payment with saved m10 payment method
          format: uuid
    TransactionDto:
      required:
        - createdAt
        - currencyISO
        - orderId
        - transactionId
      type: object
      properties:
        orderId:
          pattern: '[a-zA-Z0-9_-]{20,64}'
          type: string
          description: Unique order id for this merchant provided by the merchant
        transactionId:
          type: string
          description: Unique ID of the processed transaction in m10
          format: uuid
        originalTransactionId:
          type: string
          description: Unique ID of the original transaction in m10 in case of refund
          format: uuid
        transactionType:
          type: string
          description: Type of transaction
          enum:
            - PAYMENT
            - REFUND
            - TOKENIZATION
            - PAYMENT
            - REFUND
        currencyISO:
          type: string
          description: CurrencyISO of the transaction
          example: AZN
          enum:
            - AZN
            - USD
            - EUR
            - RUR
        amount:
          type: string
          description: Amount paid by user during purchase or returned to user during refund
          example: '10.51'
        netAmount:
          type: string
          description: Amount paid to merchant during purchase or received from merchant during refund
          example: '10.3'
        status:
          type: string
          description: Order status in m10
          enum:
            - CREATED
            - IN_PROGRESS
            - SUCCESS
            - CANCEL
            - FAILURE
        createdAt:
          type: string
          description: Moment when transaction was created
          format: date-time
        userdata:
          type: string
          description: Any userdata previously supplied by the merchant, not parsed on m10 side, returned unchanged
        metadata:
          type: object
          additionalProperties:
            type: object
            description: Additional merchant specific parameters
          description: Additional merchant specific parameters
    SseEmitter:
      type: object
      properties:
        timeout:
          type: integer
          format: int64
    OrderDto:
      required:
        - currencyISO
        - orderId
        - transactionType
      type: object
      properties:
        amount:
          type: string
          description: Amount paid by user during purchase or returned to user during refund
          example: '10.51'
        currencyISO:
          type: string
          description: CurrencyISO of the transaction
          example: AZN
          enum:
            - AZN
            - USD
            - EUR
            - RUR
        metadata:
          type: object
          additionalProperties:
            type: object
            description: Additional merchant specific parameters
          description: Additional merchant specific parameters
        netAmount:
          type: string
          description: Amount paid to merchant during purchase or received from merchant during refund
          example: '10.3'
        orderId:
          pattern: '[a-zA-Z0-9_-]{20,64}'
          type: string
          description: Unique order id for this merchant provided by the merchant
        originalTransactionId:
          type: string
          description: Unique ID of the original transaction in m10 in case of refund
          format: uuid
        status:
          type: string
          description: Order status in m10
          enum:
            - CREATED
            - IN_PROGRESS
            - SUCCESS
            - CANCEL
            - FAILURE
        transactionId:
          type: string
          description: Unique ID of the processed transaction in m10. Null if order was canceled or not processed yet
          format: uuid
        transactionType:
          type: string
          description: Type of transaction
          enum:
            - PAYMENT
            - REFUND
            - TOKENIZATION
            - PAYMENT
            - REFUND
        userToken:
          type: string
          description: Token for quick payment with saved m10 payment method when X-User-Tokenization header has value 'REQUIRED'
          format: uuid
        userdata:
          type: string
          description: Any userdata previously supplied by the merchant, not parsed on m10 side, returned unchanged
  securitySchemes:
    m10:
      type: http
      description: M10 api key.
      scheme: Bearer
    Merchant:
      type: http
      description: Provided api key.
      scheme: Bearer